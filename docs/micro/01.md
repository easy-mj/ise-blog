---
title: 微前端
categories:
  - 前端架构
tags:
  - 微前端
author:
  name: MJ
  link: https://github.com/easy-mj/ise-blog
---

# 1. 自研框架

## 1.1 自研框架的具体实现

- 路由分发式
- 主应用控制路由匹配和子应用加载，共享依赖加载
- 子应用做功能，并接入主应用实现主子应用的控制和联动

## 1.2 自研框架的技术选型——确定技术栈

> [!TIP] 应用

- 主应用（Vue3）
- 子应用
  - Vue2 子应用（新能源汽车页面）
  - Vue3 子应用（首页、选车）
  - React15 子应用（资讯、视频、视频详情）
  - React16 子应用（新车、排行、登录）
- 后端服务（Koa）和发布应用（Express）
- 微前端的框架（原生 Node.js+JavaScript）

> [!TIP] 选型依据

具体在工作中，我们公司的技术栈是什么，公司的基础建设都是以什么技术栈发展的，就可以根据当前的实际情况来确定主应用和子应用的技术栈，这样相对来说实现的成本是比较低的，如果说所有的应用要接入到微前端里面，后期的接入改动成本也是比较低的。

除去公司基础建设还需要考虑其他因素，如果说当前这个功能是比较重要的，在所有的浏览器上都需要这个功能能够正常的使用，那么这时候选用的技术就不能选择比较新的技术而是那些比较成熟的技术，可以通过比较成熟的技术完成所有的兼容性问题，如果说当前项目是比较重要的，那么就选择跟当前项目比较契合的技术，如果说并不太重要的内容或者说流量并不大的内容，这时候就可以选择一些比较新的技术，做一些新技术的试错。

还有就是团队的因素，如果团队整体上对 Vue 技术栈是比较熟悉的，这时候选择 Vue 技术栈不仅仅可以提升开发速度，也可以降低我们的开发出错率，对于整体实现来说也是比较友好的，如果说团队所有的技术栈都接触过，或者说对于所有的技术栈都有所涉猎，那么这时候选取 Vue、React 或者其他的技术栈都是没有问题的。

最后要看技术栈的内容，看它当前是否是可以维护的，是否是易于拓展的，性能是不是好的等等内容。

## 1.3 绘制项目架构图

> [!TIP] 分析需求

- 主子应用功能
  - 主应用
    - 注册子应用
    - 加载、渲染子应用
    - 路由匹配（activeWhen、rules - 由框架判断）
    - 获取数据（公共依赖，通过数据做鉴权处理）
    - 通信（父子通信，子父通信）
  - 子应用
    - 渲染
    - 监听通信（主应用传递过来的数据）
- 微前端框架的功能

  - 子应用的注册
  - 开始内容（应用加载完成）
  - 路由更新判断
  - 匹配对应的子应用
  - 加载子应用的内容
  - 完成所有依赖项的执行
  - 将子应用渲染在固定的容器内
  - 公共的事件管理
  - 异常的捕获和报错
  - 全局的状态管理的内容
  - 沙箱的隔离
  - 通信机制

- 服务端的功能
  - 提供数据服务
- 发布平台
  - 主子应用的打包和发布

> [!TIP] 绘制项目架构图(https://www.processon.com/)

![micro image](/img/micro-arch.png)
